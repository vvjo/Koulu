(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){},17:function(e,t,n){e.exports=n(41)},41:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),l=n(16),o=n.n(l),c=n(4),u=n(1),s=n.n(u),i=n(3),p=function(e){var t=Object(r.useState)(""),n=Object(c.a)(t,2),a=n[0],l=n[1];return{type:e,value:a,onChange:function(e){l(e.target.value)},reset:function(){l("")}}},f=function(e){var t=p("text"),n=p("password"),r=function(){var r=Object(i.a)(s.a.mark(function r(a){var l,o,c;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a.preventDefault(),r.prev=1,l=t.value,o=n.value,r.next=6,e.login.login({username:l,password:o});case 6:c=r.sent,window.localStorage.setItem("loggeduser",JSON.stringify(c)),e.setUser(c),t.reset(),n.reset(),e.setColor("notification"),e.setMsg("User ".concat(c.name," logged in!")),setTimeout(function(){e.setMsg(null)},5e3),r.next=22;break;case 16:r.prev=16,r.t0=r.catch(1),console.log(r.t0),e.setColor("error"),e.setMsg("wrong credentials"),setTimeout(function(){e.setMsg(null)},5e3);case 22:case"end":return r.stop()}},r,null,[[1,16]])}));return function(e){return r.apply(this,arguments)}}();return a.a.createElement("form",{className:"login",onSubmit:r},a.a.createElement("div",null,"username",a.a.createElement("input",t)),a.a.createElement("div",null,"password",a.a.createElement("input",n)),a.a.createElement("button",{type:"submit"},"login"))},g=function(e){var t=e.msg,n=e.color;return null===t?null:a.a.createElement("div",{className:n},t)},m=n(5),b=n.n(m),v={login:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},d=function(e){var t=Object(r.useState)(!1),n=Object(c.a)(t,2),l=n[0],o=n[1],u={display:l?"":"none"},p=function(){var t=Object(i.a)(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={title:e.plog.title,author:e.plog.author,url:e.plog.url,likes:e.plog.likes+1},t.prev=1,t.next=4,e.blogService.like(e.plog.id,n);case 4:e.plog.likes+=1,e.setColor("notification"),e.setMsg("".concat(n.title," liked!")),setTimeout(function(){e.setMsg(null)},1e3),t.next=15;break;case 10:t.prev=10,t.t0=t.catch(1),e.setColor("error"),e.setMsg("Error while liking the blog"),setTimeout(function(){e.setMsg(null)},5e3);case 15:case"end":return t.stop()}},t,null,[[1,10]])}));return function(){return t.apply(this,arguments)}}(),f=function(){var t=Object(i.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.confirm("Delete this blog?")){t.next=16;break}return t.prev=1,t.next=4,e.blogService.del(e.plog.id);case 4:e.setColor("notification"),e.setMsg("".concat(e.plog.title,". deleted")),e.updOverlay(),setTimeout(function(){e.setMsg(null)},5e3),t.next=16;break;case 10:t.prev=10,t.t0=t.catch(1),console.log(t.t0),e.setColor("error"),e.setMsg("unauthorized"),setTimeout(function(){e.setMsg(null)},5e3);case 16:case"end":return t.stop()}},t,null,[[1,10]])}));return function(){return t.apply(this,arguments)}}();return a.a.createElement("li",null,a.a.createElement("div",{className:"clickable",onClick:function(){o(!l)}},e.plog.title,a.a.createElement("br",null),e.plog.author),a.a.createElement("div",{className:"showWhenClicked",style:u},e.plog.url,a.a.createElement("br",null),e.plog.likes,a.a.createElement("button",{onClick:function(){return p()}},"like this"),a.a.createElement("br",null),"added by ",e.plog.user.name,a.a.createElement("br",null),function(){if(e.user.username===e.plog.user.username)return a.a.createElement("button",{onClick:function(){return f()}},"remove")}()))},E=function(e){e.blogs.sort(function(e,t){return Number(t.likes)-Number(e.likes)});var t=e.blogs.map(function(t){return a.a.createElement(d,{updOverlay:e.updOverlay,key:e.blogs.indexOf(t),id:e.blogs.indexOf(t),plog:t,blogService:e.blogService,setMsg:e.setMsg,setColor:e.setColor,user:e.user})});return a.a.createElement("ul",null,t)},h=function(e){var t=p("text"),n=p("text"),r=p("text"),l=function(){var a=Object(i.a)(s.a.mark(function a(){var l,o,c,u;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=t.value,o=n.value,c=r.value,u={title:l,author:o,url:c},a.prev=4,a.next=7,e.blogService.create(u);case 7:t.reset(),n.reset(),r.reset(),e.setColor("notification"),e.setMsg("New blog ".concat(l," added!")),setTimeout(function(){e.setMsg(null)},5e3),a.next=21;break;case 15:a.prev=15,a.t0=a.catch(4),console.log(a.t0),e.setColor("error"),e.setMsg("Error while creating a new blog"),setTimeout(function(){e.setMsg(null)},5e3);case 21:case"end":return a.stop()}},a,null,[[4,15]])}));return function(){return a.apply(this,arguments)}}();return a.a.createElement("form",{onSubmit:l},a.a.createElement("div",null,"title: ",a.a.createElement("input",t),a.a.createElement("br",null),"author: ",a.a.createElement("input",n),a.a.createElement("br",null),"url: ",a.a.createElement("input",r)),a.a.createElement("div",null,a.a.createElement("button",{type:"submit"},"create")))},w=a.a.forwardRef(function(e,t){var n=Object(r.useState)(!1),l=Object(c.a)(n,2),o=l[0],u=l[1],s={display:o?"none":""},i={display:o?"":"none"},p=function(){u(!o)};return Object(r.useImperativeHandle)(t,function(){return{toggleVisibility:p}}),a.a.createElement("div",null,a.a.createElement("div",{style:s},a.a.createElement("button",{onClick:p},e.buttonLabel)),a.a.createElement("div",{style:i},e.children,a.a.createElement("button",{onClick:p},"cancel")))}),k=null,O={getAll:function(){var e=Object(i.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(i.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,b.a.post("/api/blogs",t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){k="bearer ".concat(e)},like:function(e,t){return b.a.put("".concat("/api/blogs","/").concat(e),t).then(function(e){return e.data})},del:function(){var e=Object(i.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,b.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()};n(15);var x=function(){var e=Object(r.useState)(null),t=Object(c.a)(e,2),n=t[0],l=t[1],o=Object(r.useState)("notification"),u=Object(c.a)(o,2),s=u[0],i=u[1],p=Object(r.useState)(null),m=Object(c.a)(p,2),b=m[0],d=m[1],k=Object(r.useState)([]),x=Object(c.a)(k,2),y=x[0],j=x[1];return Object(r.useEffect)(function(){O.getAll().then(function(e){j(e)})},[]),Object(r.useEffect)(function(){var e=window.localStorage.getItem("loggeduser");if(e){var t=JSON.parse(e);d(t),O.setToken(t.token)}},[]),a.a.createElement("div",null,a.a.createElement("h1",null,"Blogs"),a.a.createElement(g,{msg:n,color:s}),null===b?a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Login"),a.a.createElement("br",null),a.a.createElement(f,{setUser:d,setMsg:l,setColor:i,login:v})):a.a.createElement(a.a.Fragment,null,a.a.createElement("p",{className:"usertext"},b.name," logged in"),a.a.createElement("button",{onClick:function(){return window.localStorage.clear(),d(null),i("notification"),l("User ".concat(b.name," logged out")),void setTimeout(function(){l(null)},5e3)}},"Logout"),a.a.createElement("br",null),a.a.createElement(E,{updOverlay:function(){O.getAll().then(function(e){j(e)})},blogs:y,blogService:O,setMsg:l,setColor:i,user:b}),a.a.createElement(w,{buttonLabel:"new blog"},a.a.createElement(h,{blogService:O,setMsg:l,setColor:i}))))};o.a.render(a.a.createElement(x,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.21b91454.chunk.js.map